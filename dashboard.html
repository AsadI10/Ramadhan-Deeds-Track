<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div class="container">
        <h2>Ramadhan Good Deeds Tracker</h2>
        
        <!-- Ramadhan Calendar -->
        <div id="calendar-container">
            <h3>Ramadhan Calendar</h3>
            <input type="date" id="date-picker">
            <button onclick="showPrayerTimes()">Show Salah Times</button>
            <p id="reminder-message"></p>
            <h4>Missed Fasts: <span id="missed-fasts">0</span></h4>
            <button onclick="markMissedFast()">Mark Missed Fast</button>
            <div id="missed-fasts-list"></div>
        </div>

        <!-- Daily Hadith/Quote -->
        <div id="daily-hadith">
            <h3>Daily Islamic Quote</h3>
            <p id="hadith-text">"The best among you are those who bring the most benefit to others." - Prophet Muhammad (SAW)</p>
            <button onclick="getNewHadith()">New Quote</button>
        </div>
        
        <!-- Good Deeds List -->
        <div id="deeds-list">
            <h3>Good Deeds Checklist</h3>
            <div class="deed"><span>Prayed all 5 daily prayers</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Gave charity</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Helped someone in need</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Read Quran</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Did Dhikr (remembrance of Allah)</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Fasted the whole day</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Made dua for others</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Prayed Taraweeh</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Donated to charity</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Avoided bad habits</span><input type="checkbox" class="deed-checkbox"></div>
            <div class="deed"><span>Learned something new about Islam</span><input type="checkbox" class="deed-checkbox"></div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <!-- Daily Notes Section
        <div id="notes-section">
            <h3>Daily Reflections</h3>
            <textarea id="daily-notes" placeholder="Write your thoughts here..."></textarea>
            <button onclick="saveNotes()">Save Notes</button>
        </div> -->

        <!-- Islamic Q&A -->
        <div id="qa-container">
            <h3>Ask a Question about Islam</h3>
            <input type="text" id="question" placeholder="Type your question here...">
            <button onclick="searchIslamQA()">Ask</button>
            <p id="answer"></p>
        </div>
    </div>
    <!-- Prayer times added  -->
    <div id="prayer-times-container">
        <h3>Prayer Times</h3>
        <ul id="prayer-times-list"></ul>
        <button id="close-popup" onclick="closePrayerTimes()">Close</button>
    </div>
    <audio id="adhan-audio" src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Adhan-Madina.mp3"></audio>

    <script>
        const checkboxes = document.querySelectorAll('.deed-checkbox');
        const progress = document.getElementById('progress');
        let missedFasts = 0;
        function updateProgress() {
            const total = checkboxes.length;
            const checked = document.querySelectorAll('.deed-checkbox:checked').length;
            const percentage = (checked / total) * 100;
            progress.style.width = percentage + '%';
        }
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updateProgress);
        });
        function setReminder() {
            const date = document.getElementById('date-picker').value;
            document.getElementById('reminder-message').textContent = `Reminder set for ${date}!`;
        }
        function markMissedFast() {
            missedFasts++;
            document.getElementById('missed-fasts').textContent = missedFasts;
        }
        function getNewHadith() {
            const hadiths = [
                "The best among you are those who learn the Quran and teach it.",
                "Whoever fasts during Ramadan with faith and seeking reward will have his past sins forgiven.",
                "Kindness is a mark of faith, and whoever is not kind has no faith.",
                "Do not waste water, even if you perform your ablution on the banks of an abundantly-flowing river."
            ];
            const randomHadith = hadiths[Math.floor(Math.random() * hadiths.length)];
            document.getElementById('hadith-text').textContent = randomHadith;
        }
        function saveNotes() {
            const notes = document.getElementById('daily-notes').value;
            localStorage.setItem('dailyNotes', notes);
            alert('Notes saved!');
        }
        function searchIslamQA() {
            const question = document.getElementById('question').value.trim();
            if (question) {
                const searchUrl = `https://islamqa.info/en/search?q=${encodeURIComponent(question)}`;
                window.open(searchUrl, '_blank');
            } else {
                alert('Please enter a question.');
            }
        }
        
        // added prayer times 
        async function showPrayerTimes() {
            const date = document.getElementById('date-picker').value;
            if (!date) {
                alert('Please select a date.');
                return;
            }
            try {
                const response = await fetch('https://api.aladhan.com/v1/timings?latitude=53.3811&longitude=-1.4701&method=2');
                const data = await response.json();
                const timings = data.data.timings;
                
                let prayerList = document.getElementById('prayer-times-list');
                prayerList.innerHTML = '';
                
                for (let prayer of ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha']) {
                    let listItem = document.createElement('li');
                    listItem.textContent = `${prayer}: ${timings[prayer]}`;
                    prayerList.appendChild(listItem);
                }
                
                document.getElementById('prayer-times-container').style.display = 'block';
            } catch (error) {
                alert('Error fetching prayer times. Please try again later.');
            }
        }
        function closePrayerTimes() {
            document.getElementById('prayer-times-container').style.display = 'none';
        }
        function checkPrayerTimes(timings) {
            setInterval(() => {
                let now = new Date();
                let hours = now.getHours().toString().padStart(2, '0');
                let minutes = now.getMinutes().toString().padStart(2, '0');
                let currentTime = `${hours}:${minutes}`;
                
                for (let prayer in timings) {
                    if (timings[prayer].slice(0, 5) === currentTime) {
                        document.getElementById('adhan-audio').play();
                        alert(`It's time for ${prayer}!`);
                    }
                }
            }, 60000);
        }
        
        //load missed fasts from local storage
        document.addEventListener("DOMContentLoaded", loadMissedFasts);

function markMissedFast() {
    const date = document.getElementById("date-picker").value;
    if (!date) {
        alert("Please select a date.");
        return;
    }

    let missedFasts = JSON.parse(localStorage.getItem("missedFasts")) || [];
    if (!missedFasts.includes(date)) {
        missedFasts.push(date);
        localStorage.setItem("missedFasts", JSON.stringify(missedFasts));
    }

    updateMissedFastsDisplay();
}

// Update UI to show missed fasts
function updateMissedFastsDisplay() {
    let missedFasts = JSON.parse(localStorage.getItem("missedFasts")) || [];
    document.getElementById("missed-fasts").textContent = missedFasts.length;

    let missedList = document.getElementById("missed-fasts-list");
    missedList.innerHTML = "<h5>Missed Fast Dates:</h5>";
    missedFasts.forEach(date => {
        let dateElement = document.createElement("div");
        dateElement.textContent = date;
        dateElement.classList.add("missed-fast-date");
        missedList.appendChild(dateElement);
    });
}

// Load missed fasts when page loads
function loadMissedFasts() {
    updateMissedFastsDisplay();
}
    </script>
</body>
</html>